var dialog,sendEvent,customerDomain="@microsoft.com";function onMessageSendHandler(e){var o=[],t=!1,n=!1,a=!1;function c(c,s){c.getAsync((function(c){c.status===Office.AsyncResultStatus.Succeeded&&c.value.forEach((function(e){e.emailAddress.includes(customerDomain)||o.push("".concat(e.emailAddress," in ").concat(s))})),"To"===s?t=!0:"CC"===s?n=!0:"BCC"===s&&(a=!0),t&&n&&a&&(o.length>0?Office.context.ui.displayDialogAsync("https://localhost:3000/dialog.html",{height:30,width:50,displayInIframe:!0},(function(e){console.log(e.status),(dialog=e.value).addEventHandler(Office.EventType.DialogMessageReceived,closeDialog)})):e.completed({allowEvent:!0}))}))}sendEvent=e,c(Office.context.mailbox.item.to,"To"),c(Office.context.mailbox.item.cc,"CC"),c(Office.context.mailbox.item.bcc,"BCC")}function closeDialog(e){var o=JSON.parse(e.message);"cancel"===o.messageType?(dialog.close(),sendEvent.completed({allowEvent:!1})):"sendanyways"===o.messageType&&(sendEvent.completed({allowEvent:!0}),dialog.close())}Office.context.platform!==Office.PlatformType.PC&&null!=Office.context.platform||Office.actions.associate("onMessageSendHandler",onMessageSendHandler);