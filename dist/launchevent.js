const customerDomain="@microsoft.com";let dialog,sendEvent;function onMessageSendHandler(e){let o=[],t=!1,n=!1,s=!1;function l(l,a){l.getAsync((l=>{if(l.status===Office.AsyncResultStatus.Succeeded&&l.value.forEach((e=>{e.emailAddress.includes(customerDomain)||o.push(`${e.emailAddress} in ${a}`)})),"To"===a?t=!0:"CC"===a?n=!0:"BCC"===a&&(s=!0),t&&n&&s)if(o.length>0){const e="https://localhost:3000/dialog.html";Office.context.ui.displayDialogAsync(e,{height:30,width:50,displayInIframe:!0},(function(e){console.log(e.status),dialog=e.value,dialog.addEventHandler(Office.EventType.DialogMessageReceived,closeDialog)}))}else e.completed({allowEvent:!0})}))}sendEvent=e,l(Office.context.mailbox.item.to,"To"),l(Office.context.mailbox.item.cc,"CC"),l(Office.context.mailbox.item.bcc,"BCC")}function closeDialog(e){const o=JSON.parse(e.message);"cancel"===o.messageType?(dialog.close(),sendEvent.completed({allowEvent:!1})):"sendanyways"===o.messageType&&(sendEvent.completed({allowEvent:!0}),dialog.close())}Office.context.platform!==Office.PlatformType.PC&&null!=Office.context.platform||Office.actions.associate("onMessageSendHandler",onMessageSendHandler);