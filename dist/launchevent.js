const customerDomain="@microsoft.com";let dialog;function onMessageSendHandler(e){let t=[],o=!1,c=!1,i=!1;function n(n,a){n.getAsync((n=>{if(n.status===Office.AsyncResultStatus.Succeeded&&n.value.forEach((e=>{e.emailAddress.includes(customerDomain)||t.push(`${e.emailAddress} in ${a}`)})),"To"===a?o=!0:"CC"===a?c=!0:"BCC"===a&&(i=!0),o&&c&&i)if(t.length>0){const t="https://localhost:3000/dialog.html";Office.context.ui.displayDialogAsync(t,{height:50,width:50,displayInIframe:!0},(function(t){console.log(t.status),t.status===Office.AsyncResultStatus.Failed?(Office.context.ui.closeContainer(),e.completed({allowEvent:!1})):(dialog=t.value,dialog.addEventHandler(Office.EventType.DialogEventReceived,l))}))}else e.completed({allowEvent:!0})}))}function l(){e.completed({allowEvent:!1})}n(Office.context.mailbox.item.to,"To"),n(Office.context.mailbox.item.cc,"CC"),n(Office.context.mailbox.item.bcc,"BCC")}Office.context.platform!==Office.PlatformType.PC&&null!=Office.context.platform||Office.actions.associate("onMessageSendHandler",onMessageSendHandler);