const customerDomain="@microsoft.com";function onMessageSendHandler(e){let o=[],t=!1,c=!1;function n(n,s){n.getAsync((n=>{n.status===Office.AsyncResultStatus.Succeeded&&n.value.forEach((e=>{e.emailAddress.includes(customerDomain)||o.push(`${e.emailAddress} in ${s}`)})),"To"===s?t=!0:"CC"===s&&(c=!0),t&&c&&(o.length>0?window.confirm("Are You Sure?"):e.completed({allowEvent:!0}))}))}n(Office.context.mailbox.item.to,"To"),n(Office.context.mailbox.item.cc,"CC")}Office.context.platform!==Office.PlatformType.PC&&null!=Office.context.platform||Office.actions.associate("onMessageSendHandler",onMessageSendHandler);