var dialog,customerDomain="@microsoft.com";function onMessageSendHandler(e){var t=[],o=!1,c=!1,n=!1;function a(a,l){a.getAsync((function(a){a.status===Office.AsyncResultStatus.Succeeded&&a.value.forEach((function(e){e.emailAddress.includes(customerDomain)||t.push("".concat(e.emailAddress," in ").concat(l))})),"To"===l?o=!0:"CC"===l?c=!0:"BCC"===l&&(n=!0),o&&c&&n&&(t.length>0?Office.context.ui.displayDialogAsync("https://localhost:3000/dialog.html",{height:50,width:50,displayInIframe:!0},(function(t){console.log(t.status),t.status===Office.AsyncResultStatus.Failed?(Office.context.ui.closeContainer(),e.completed({allowEvent:!1})):(dialog=t.value).addEventHandler(Office.EventType.DialogEventReceived,i)})):e.completed({allowEvent:!0}))}))}function i(){e.completed({allowEvent:!1})}a(Office.context.mailbox.item.to,"To"),a(Office.context.mailbox.item.cc,"CC"),a(Office.context.mailbox.item.bcc,"BCC")}Office.context.platform!==Office.PlatformType.PC&&null!=Office.context.platform||Office.actions.associate("onMessageSendHandler",onMessageSendHandler);