var customerDomain="@microsoft.com";function onMessageSendHandler(e){var n=[];function t(t,o){t.getAsync((function(t){t.status===Office.AsyncResultStatus.Succeeded?(t.value.forEach((function(e){e.emailAddress.includes(customerDomain)||n.push("".concat(e.emailAddress," in ").concat(o))})),n.length>0?e.completed({allowEvent:!1,errorMessage:"The mail includes some external recipients, are you sure you want to send it?\n\n"+n.join("\n")+"\n\nClick Send to send the mail anyway."}):e.completed({allowEvent:!0})):e.completed({allowEvent:!0})}))}t(Office.context.mailbox.item.to,"To"),t(Office.context.mailbox.item.cc,"Cc")}Office.context.platform!==Office.PlatformType.PC&&null!=Office.context.platform||Office.actions.associate("onMessageSendHandler",onMessageSendHandler);